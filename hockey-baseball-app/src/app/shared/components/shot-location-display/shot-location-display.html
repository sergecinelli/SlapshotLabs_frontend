<div class="shot-location-display-container">
  <!-- Stats Labels -->
  <div class="stats-labels">
    @for (stat of stats(); track stat.type) {
      <div
        class="stat-label"
        [class.inactive]="!stat.isVisible"
        aria-hidden="true"
        (click)="toggleType(stat.type)"
      >
        <span class="stat-dot" [style.background-color]="stat.color"></span>
        <span class="stat-text">{{ stat.label }}: {{ stat.count }}</span>
      </div>
    }
  </div>

  <!-- Location Images Grid -->
  <div class="location-images">
    <!-- Rink Image -->
    <div class="location-container">
      @if (showDirection()) {
        <div class="direction-indicator">
          <svg class="direction-arrow" viewBox="0 0 200 40" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <marker
                id="arrowhead"
                markerWidth="10"
                markerHeight="10"
                refX="9"
                refY="3"
                orient="auto"
              >
                <polygon points="0 0, 10 3, 0 6" fill="#ef4444" />
              </marker>
            </defs>
            <line
              x1="10"
              y1="20"
              x2="190"
              y2="20"
              stroke="#ef4444"
              stroke-width="3"
              marker-end="url(#arrowhead)"
            />
          </svg>
        </div>
      }
      <div class="location-wrapper">
        <img src="/assets/images/hockey-rink.svg" alt="Hockey Rink" class="location-image" />
        @for (item of rinkItems(); track $index) {
          <div
            class="location-marker"
            [class.marker-large]="item.index >= 100"
            [class.marker-medium]="item.index >= 10 && item.index < 100"
            [style.top.%]="item.iceTopOffset"
            [style.left.%]="item.iceLeftOffset"
            [style.background-color]="item.color"
            [matTooltip]="item.tooltip || buildTooltip(item)"
            [matTooltipClass]="'spray-chart-tooltip'"
          >
            <span class="marker-dot"></span>
            <span class="marker-badge">{{ item.index }}</span>
          </div>
        }
      </div>
    </div>

    <!-- Net Image -->
    <div class="location-container">
      @if (goalieId() && goalieName() && showGoalieName()) {
        <div class="goalie-info">
          <div class="goalie-photo-container">
            @if (goaliePhotoLoaded()) {
              <img 
                [src]="getGoalieLogoUrl()" 
                alt="Goalie Photo" 
                class="goalie-logo" 
                (error)="onGoaliePhotoError()"
                (load)="onGoaliePhotoLoad()"
              />
            } @else {
              <div class="goalie-initials">{{ getGoalieInitials() }}</div>
            }
          </div>
          <span class="goalie-name">{{ goalieName() }}</span>
        </div>
      }
      <div class="location-wrapper">
        <img src="/assets/images/net.svg" alt="Net" class="location-image" />
        @for (item of netItems(); track $index) {
          <div
            class="location-marker"
            [class.marker-large]="item.index >= 100"
            [class.marker-medium]="item.index >= 10 && item.index < 100"
            [style.top.%]="item.netTopOffset"
            [style.left.%]="item.netLeftOffset"
            [style.background-color]="item.color"
            [matTooltip]="item.tooltip || buildTooltip(item)"
            [matTooltipClass]="'spray-chart-tooltip'"
          >
            <span class="marker-dot"></span>
            <span class="marker-badge">{{ item.index }}</span>
          </div>
        }
      </div>
    </div>
  </div>
</div>
